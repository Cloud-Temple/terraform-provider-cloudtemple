---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cloudtemple_compute_virtual_machine Resource - terraform-provider-cloudtemple"
subcategory: "Compute"
description: |-
  Provision a virtual machine. This allows instances to be created, updated, and deleted.
  Virtual machines can be created using three different methods:
  by creating a new instance with guest_operating_system_morefby cloning an existing virtual machine with clone_virtual_machine_idby deploying a content library item with content_library_id and content_library_item_id
  To manage this resource you will need the following roles:
    - compute_write
    - compute_read
    - activity_read
    - tag_read
    - tag_write
---

# cloudtemple_compute_virtual_machine (Resource)

Provision a virtual machine. This allows instances to be created, updated, and deleted.

Virtual machines can be created using three different methods:

  - by creating a new instance with `guest_operating_system_moref`
  - by cloning an existing virtual machine with `clone_virtual_machine_id`
  - by deploying a content library item with `content_library_id` and `content_library_item_id`

To manage this resource you will need the following roles:
  - `compute_write`
  - `compute_read`
  - `activity_read`
  - `tag_read`
  - `tag_write`

## Example Usage

```terraform
data "cloudtemple_compute_virtual_datacenter" "TH3S" {
  name = "DC-TH3S"
}

data "cloudtemple_compute_host_cluster" "CLU_001" {
  name = "clu001-ucs12"
}

data "cloudtemple_compute_datastore_cluster" "SDRS_001" {
  name = "sdrs001-LIVE_"
}

# Deploying a new virtual machine with a given operating system
resource "cloudtemple_compute_virtual_machine" "from_scratch" {
  name = "from_scratch"

  memory                 = 8 * 1024 * 1024 * 1024
  cpu                    = 2
  num_cores_per_socket   = 1
  cpu_hot_add_enabled    = true
  cpu_hot_remove_enabled = true
  memory_hot_add_enabled = true
  power_state            = "off"

  datacenter_id                = data.cloudtemple_compute_virtual_datacenter.TH3S.id
  host_cluster_id              = data.cloudtemple_compute_host_cluster.CLU_001.id
  datastore_cluster_id         = data.cloudtemple_compute_datastore_cluster.SDRS_001.id
  guest_operating_system_moref = "amazonlinux2_64Guest"

  tags = {
    created_by = "Terraform"
  }

  lifecycle {
    prevent_destroy = true
  }
}

# Clone an already existing virtual machine
resource "cloudtemple_compute_virtual_machine" "cloned" {
  name = "cloned"

  clone_virtual_machine_id = cloudtemple_compute_virtual_machine.scratch.id

  datacenter_id        = data.cloudtemple_compute_virtual_datacenter.dc.id
  host_cluster_id      = data.cloudtemple_compute_host_cluster.flo.id
  datastore_cluster_id = data.cloudtemple_compute_datastore_cluster.koukou.id

  tags = {
    created_by = "Terraform"
  }
}

# Deploy an item from the content library
data "cloudtemple_compute_content_library" "public" {
  name = "PUBLIC"
}

data "cloudtemple_compute_content_library_item" "centos" {
  content_library_id = data.cloudtemple_compute_content_library.public.id
  name               = "20211115132417_master_linux-centos-8"
}

data "cloudtemple_compute_datastore" "ds" {
  name = "ds001-bob-svc1-data4-eqx6"
}

resource "cloudtemple_compute_virtual_machine" "content-library" {
  name = "from-content-library-item"

  content_library_id      = data.cloudtemple_compute_content_library.public.id
  content_library_item_id = data.cloudtemple_compute_content_library_item.centos.id

  datacenter_id        = data.cloudtemple_compute_virtual_datacenter.dc.id
  host_cluster_id      = data.cloudtemple_compute_host_cluster.flo.id
  datastore_cluster_id = data.cloudtemple_compute_datastore_cluster.koukou.id
  datastore_id         = data.cloudtemple_compute_datastore.ds.id

  deploy_options = {
    trak_sshpublickey = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKpZ5juF5a/CXV9nQ0PANptTG9Gh3J0aj6yVjkF0fSkC remi@cloud-temple.com"
  }

  tags = {
    created_by = "Terraform"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `datacenter_id` (String) The datacenter to start the virtual machine in.
- `host_cluster_id` (String) The host cluster to start the virtual machine on.
- `name` (String)

### Optional

- `clone_virtual_machine_id` (String) The ID of the virtual machine to clone. Conflicts with `guest_operating_system_moref` and `content_library_item_id`.
- `content_library_id` (String) The ID of the content library to clone from. Conflicts with `guest_operating_system_moref` and `clone_virtual_machine_id`.
- `content_library_item_id` (String) The ID of the content library item to clone. Conflicts with `guest_operating_system_moref` and `clone_virtual_machine_id`.
- `cpu` (Number) The number of CPUs to start the virtual machine with.
- `cpu_hot_add_enabled` (Boolean)
- `cpu_hot_remove_enabled` (Boolean)
- `datastore_cluster_id` (String)
- `datastore_id` (String)
- `deploy_options` (Map of String)
- `guest_operating_system_moref` (String) The operating system to launch the virtual machine with. Conflicts with `clone_virtual_machine_id` and `content_library_item_id`.
- `host_id` (String) The host to start the virtual machine on.
- `memory` (Number) The quantity of memory to start the virtual machine with.
- `memory_hot_add_enabled` (Boolean)
- `num_cores_per_socket` (Number)
- `power_state` (String) Whether to start the virtual machine.
- `tags` (Map of String) The tags to attach to the virtual machine.

### Read-Only

- `boot_options` (List of Object) (see [below for nested schema](#nestedatt--boot_options))
- `consolidation_needed` (Boolean)
- `cpu_usage` (Number)
- `datastore_name` (String)
- `distributed_virtual_port_group_ids` (List of String)
- `extra_config` (List of Object) (see [below for nested schema](#nestedatt--extra_config))
- `hardware_version` (String)
- `id` (String) The ID of this resource.
- `machine_manager_id` (String)
- `machine_manager_name` (String)
- `machine_manager_type` (String)
- `memory_usage` (Number)
- `moref` (String)
- `operating_system_name` (String)
- `replication_config` (List of Object) (see [below for nested schema](#nestedatt--replication_config))
- `snapshoted` (Boolean)
- `spp_mode` (String)
- `storage` (List of Object) (see [below for nested schema](#nestedatt--storage))
- `template` (Boolean)
- `tools` (String)
- `tools_version` (Number)
- `triggered_alarms` (List of Object) (see [below for nested schema](#nestedatt--triggered_alarms))

<a id="nestedatt--boot_options"></a>
### Nested Schema for `boot_options`

Read-Only:

- `boot_delay` (Number)
- `boot_retry_delay` (Number)
- `boot_retry_enabled` (Boolean)
- `enter_bios_setup` (Boolean)
- `firmware` (String)


<a id="nestedatt--extra_config"></a>
### Nested Schema for `extra_config`

Read-Only:

- `key` (String)
- `value` (String)


<a id="nestedatt--replication_config"></a>
### Nested Schema for `replication_config`

Read-Only:

- `disk` (List of Object) (see [below for nested schema](#nestedobjatt--replication_config--disk))
- `encryption_destination` (Boolean)
- `generation` (Number)
- `net_compression_enabled` (Boolean)
- `net_encryption_enabled` (Boolean)
- `opp_updates_enabled` (Boolean)
- `paused` (Boolean)
- `quiesce_guest_enabled` (Boolean)
- `rpo` (Number)
- `vm_replication_id` (String)

<a id="nestedobjatt--replication_config--disk"></a>
### Nested Schema for `replication_config.disk`

Read-Only:

- `disk_replication_id` (String)
- `key` (Number)



<a id="nestedatt--storage"></a>
### Nested Schema for `storage`

Read-Only:

- `committed` (Number)
- `uncommitted` (Number)


<a id="nestedatt--triggered_alarms"></a>
### Nested Schema for `triggered_alarms`

Read-Only:

- `id` (String)
- `status` (String)


